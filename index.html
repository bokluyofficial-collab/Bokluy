<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Bokluy - Premium Digital Marketplace</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- Main Marketplace Page -->
<div id="mainPage" class="page active">
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo" onclick="showPage('mainPage')">
          <img src="./images/logo.jpg" alt="Bokluy Logo" class="logo-img"
               onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
          <span class="logo-text">Bokluy</span>
        </div>

        <div class="nav-buttons header-actions">
          <!-- ADD LISTING (admin-only shown by script.js) -->
          <button id="addListingBtn" class="btn btn-success" style="display:none;">
            <span class="btn-icon">âœ¨</span>
            <span>Add Listing</span>
          </button>

          <!-- TOP UP -->
          <button class="btn btn-success" onclick="showPage('topupPage')" type="button">
            <span class="btn-icon">ğŸ›’</span>
            <span>Top Up</span>
          </button>

          <!-- ORDERS (owner only shown by script.js) -->
          <button id="ordersBtn" class="btn btn-warning" style="display:none;" onclick="showPage('ordersPage')" type="button">
            <span class="btn-icon">ğŸ“¦</span>
            <span>Orders</span>
          </button>

          <!-- CHAT -->
          <button class="btn btn-primary" onclick="showPage('chatPage')">
            <span class="btn-icon">ğŸ’¬</span>
            <span>Support Chat</span>
          </button>

          <!-- LOGIN (LOGGED OUT) -->
          <a id="login-link" href="./auth.html" class="btn btn-dark" style="display:inline-flex;">
            Login
          </a>

          <!-- USER MENU (LOGGED IN) -->
          <div id="user-menu" class="user-menu" style="display:none;">
            <span id="user-name" class="user-name">User</span>
            <button id="logout-btn" class="logout-btn" type="button">Logout</button>
          </div>
        </div>
      </div>
    </div>
  </header>

    <!-- Search & Filters -->
    <div class="search-section">
      <div class="search-header">
        <h2 class="section-title">ğŸ” Find Your Perfect Deal</h2>
        <p class="section-subtitle">Search across thousands of listings</p>
      </div>

      <div class="search-bar-container">
        <span class="search-icon">ğŸ”</span>
        <input type="text" class="search-bar" id="searchInput" placeholder="Search for items, games, or deals...">
      </div>

      <div class="filters-container">
        <div class="filters-header">
          <span class="filter-title">âš™ï¸ Filters</span>
          <button class="reset-filters" onclick="resetFilters()" type="button">Reset All</button>
        </div>
        <div class="filters">
          <div class="filter-group">
            <label>ğŸ¯ Game</label>
            <select id="gameSelect">
              <option value="all">All Games</option>
            </select>
          </div>

          <div class="filter-group">
            <label>ğŸ“‹ Type</label>
            <select id="filterType">
              <option value="">All Types</option>
              <option value="BUYING">ğŸŸ¢ Buying</option>
              <option value="SELLING">ğŸ”´ Selling</option>
            </select>
          </div>

          <div class="filter-group">
            <label>ğŸ’° Min Price</label>
            <input type="number" id="filterMinPrice" placeholder="0" min="0">
          </div>

          <div class="filter-group">
            <label>ğŸ’° Max Price</label>
            <input type="number" id="filterMaxPrice" placeholder="âˆ" min="0">
          </div>

          <div class="filter-group">
            <label>ğŸ”„ Sort By</label>
            <select id="filterSort">
              <option value="newest">â° Newest First</option>
              <option value="priceLow">ğŸ’µ Price: Low â†’ High</option>
              <option value="priceHigh">ğŸ’ Price: High â†’ Low</option>
              <option value="bestValue">â­ Best Value</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- Items Grid -->
    <div class="listings-section">
      <div class="section-header">
        <h2 class="section-title">ğŸ›ï¸ Available Listings</h2>
        <div class="view-toggles">
          <button class="view-btn active" onclick="setGridView('grid')" type="button">
            <span>âŠ</span> Grid
          </button>
          <button class="view-btn" onclick="setGridView('list')" type="button">
            <span>â˜°</span> List
          </button>
        </div>
      </div>
      <div class="items-grid" id="listingsGrid"></div>
    </div>
  </div>
</div>

<!-- Add Listing Page -->
<div id="addListingPage" class="page">
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo" onclick="showPage('mainPage')">
          <img src="./images/logo.jpg" alt="Bokluy Logo" class="logo-img"
               onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
          <span class="logo-text">ğŸ® Bokluy</span>
        </div>
        <div class="nav-buttons">
          <button class="btn btn-primary" onclick="showPage('mainPage')" type="button">
            <span class="btn-icon">â†</span>
            <span>Back to Marketplace</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="form-page-wrapper">
      <div class="form-sidebar">
        <div class="form-sidebar-content">
          <div class="form-sidebar-icon">âœ¨</div>
          <h3>Create Your Listing</h3>
          <p>Fill out the form to list your item on the marketplace</p>
          <div class="form-tips">
            <div class="tip-item"><span class="tip-icon">ğŸ’¡</span><span>Be clear and detailed</span></div>
            <div class="tip-item"><span class="tip-icon">ğŸ“¸</span><span>Accurate pricing helps</span></div>
            <div class="tip-item"><span class="tip-icon">âš¡</span><span>Respond quickly to buyers</span></div>
          </div>
        </div>
      </div>

      <div class="form-page-container">
        <h1 class="page-title">Add New Listing</h1>

        <form id="listingForm" class="listing-form">
          <div class="form-section">
            <h3 class="form-section-title">ğŸ“¦ Item Details</h3>

            <div class="form-group">
              <label>ğŸ¯ Select Game *</label>
              <select id="listingGame" required>
                <option value="">Choose a game...</option>
              </select>
            </div>

            <div class="form-group">
              <label>ğŸ“ Item Name *</label>
              <div class="autocomplete-container">
                <input type="text" id="listingItem" placeholder="Start typing item name..." required autocomplete="off">
                <ul id="autocompleteList" class="autocomplete-list"></ul>
              </div>
            </div>

            <div class="form-group">
              <label>ğŸ·ï¸ Listing Type *</label>
              <select id="listingType" required>
                <option value="">Choose type...</option>
                <option value="BUYING">ğŸŸ¢ Buying</option>
                <option value="SELLING">ğŸ”´ Selling</option>
              </select>
            </div>
          </div>

          <div class="form-section">
            <h3 class="form-section-title">ğŸ’° Pricing & Quantity</h3>

            <div class="form-row">
              <div class="form-group">
                <label>ğŸ’µ Price *</label>
                <input type="number" id="listingPrice" placeholder="1000" required min="0" step="0.01">
              </div>

              <div class="form-group">
                <label>ğŸ“Š Quantity *</label>
                <input type="number" id="listingQuantity" placeholder="1" required min="1" value="1">
              </div>
            </div>
          </div>

          <div class="form-section">
            <h3 class="form-section-title">ğŸ“ Contact Information</h3>

            <div class="form-group">
              <label>ğŸ’¬ Contact Method *</label>
              <select id="contactMethod" required>
                <option value="">Choose contact method...</option>
                <option value="chat">ğŸ’¬ In-Website Chat</option>
                <option value="discord">ğŸ® Discord</option>
              </select>
            </div>

            <div class="form-group" id="discordLabel" style="display:none;">
              <label>ğŸ® Discord Username *</label>
              <input type="text" id="discordUsername" placeholder="username#1234">
            </div>

            <div class="form-group">
              <label>ğŸ“ Additional Notes (Optional)</label>
              <textarea id="listingNotes" placeholder="Any additional information about your item..."></textarea>
            </div>
          </div>

          <button type="submit" class="btn btn-submit">
            <span class="btn-icon">âœ…</span>
            <span>Submit Listing</span>
          </button>
        </form>
      </div>
    </div>
  </div>
</div>

<!-- Chat Page -->
<div id="chatPage" class="page">
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo" onclick="showPage('mainPage')">
          <img src="./images/logo.jpg" alt="Bokluy Logo" class="logo-img"
               onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
          <span class="logo-text">ğŸ® Bokluy</span>
        </div>
        <div class="nav-buttons">
          <button class="btn btn-primary" onclick="showPage('mainPage')" type="button">
            <span class="btn-icon">â†</span>
            <span>Back to Marketplace</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <div class="container">
    <div class="chat-page-header">
      <h1 class="page-title" id="chatPageTitle">ğŸ’¬ Chat</h1>
      <p class="page-subtitle" id="chatPageSubtitle">Connect instantly</p>
    </div>

    <div class="chat-container">
      <div class="chat-rooms-panel" id="chatRoomsPanel">
        <div class="chat-panel-header">
          <h2>ğŸ’¬ Your Conversations</h2>
          <span class="online-indicator" id="chatOnlineIndicator">ğŸŸ¢ Online</span>
        </div>

        <div class="create-room-section" id="createRoomSection">
          <input type="text" id="newRoomName" class="chat-input" placeholder="Create new room...">
          <button id="createRoomBtn" class="btn btn-primary" type="button"><span>+</span></button>
        </div>

        <div class="rooms-list" id="chatRoomsList">
          <div class="no-rooms">
            <div class="empty-state-icon">ğŸ’­</div>
            <p>No chat rooms yet</p>
            <small>Create one to get started!</small>
          </div>
        </div>
      </div>

      <div class="chat-messages-panel">
        <div class="chat-panel-header">
          <div class="chat-header-info">
            <h2 id="chatTitle">Select a chat room</h2>
            <span class="chat-status" id="chatStatusText">Start a conversation</span>
          </div>
        </div>

        <div class="chat-messages" id="chatMessages">
          <div class="no-messages">
            <div class="empty-state-icon">ğŸ“­</div>
            <p>No messages yet</p>
            <small>Select a room to start chatting</small>
          </div>
        </div>

        <div class="chat-input-section">
          <input type="text" id="chatInput" class="chat-input" placeholder="Type your message...">
          <button id="sendChatBtn" class="btn btn-primary" type="button"><span>ğŸ“¤</span></button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Confirm Modal -->
<div id="confirmModal" class="modal-overlay" hidden>
  <div class="modal-card" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
    <div class="modal-header">
      <h3 id="confirmTitle" class="modal-title">Confirm</h3>
      <button id="confirmCloseBtn" class="modal-close" type="button" aria-label="Close">Ã—</button>
    </div>
    <p id="confirmMessage" class="modal-message">Are you sure?</p>
    <div class="modal-actions">
      <button id="confirmCancelBtn" class="modal-btn" type="button">Cancel</button>
      <button id="confirmOkBtn" class="modal-btn danger" type="button">Delete</button>
    </div>
  </div>
</div>

<!-- Action Modal -->
<div id="actionModal" class="modal-overlay" hidden>
  <div class="modal-card">
    <div class="modal-header">
      <h3 id="modalTitle" class="modal-title">Done</h3>
      <button id="modalCloseBtn" class="modal-close" type="button">Ã—</button>
    </div>
    <p id="modalMessage" class="modal-message">Action completed.</p>
    <div class="modal-actions">
      <button id="modalOkBtn" class="modal-btn primary" type="button">OK</button>
    </div>
  </div>
</div>

<!-- Scripts (load once, in order) -->
<script src="./products/blox_fruits.js"></script>
<script src="./products/anime_last_stand.js"></script>
<script type="module" src="./chat/chat.js"></script>
<script type="module" src="./script.js"></script>


<!-- Top Up Page -->
<div id="topupPage" class="page">
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo" onclick="showPage('mainPage')">
          <img src="./images/logo.jpg" alt="Bokluy Logo" class="logo-img"
               onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
          <span class="logo-text">Bokluy</span>
        </div>
        <div class="nav-buttons">
          <button class="btn btn-primary" onclick="showPage('mainPage')" type="button">
            <span class="btn-icon">â†</span>
            <span>Back</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <div class="page-header">
        <h1 class="page-title">ğŸ›’ Top Up Request</h1>
        <p class="page-subtitle">Submit your details â€” weâ€™ll confirm and process your top up.</p>
      </div>

      <div class="card form-card">
        <form id="topupForm" class="listing-form">
          <div class="form-grid">
            <div class="form-group">
              <label>ğŸ® Game</label>
              <select id="topupGame" required>
                <option value="">Choose a game...</option>
                <option value="MLBB">Mobile Legends (MLBB)</option>
                <option value="PUBG">PUBG Mobile</option>
                <option value="Free Fire">Free Fire</option>
                <option value="Other">Other</option>
              </select>
            </div>

            <div class="form-group">
              <label>ğŸ†” Player ID</label>
              <input id="topupPlayerId" type="text" placeholder="Your in-game ID" required>
            </div>

            <div class="form-group">
              <label>ğŸŒ Server / Zone (optional)</label>
              <input id="topupServer" type="text" placeholder="Example: 1234 (optional)">
            </div>

            <div class="form-group">
              <label>ğŸ’ Amount / Package</label>
              <input id="topupAmount" type="text" placeholder="Example: 500 diamonds / Weekly Pass" required>
            </div>
          </div>

          <div class="form-group">
            <label>ğŸ“ Note (optional)</label>
            <textarea id="topupNote" rows="4" placeholder="Any extra info (screenshot details, preferred time, etc.)"></textarea>
          </div>

          <div class="form-actions">
            <button class="btn btn-success" type="submit">
              <span class="btn-icon">âœ…</span>
              <span>Submit Request</span>
            </button>
          </div>
        </form>
      </div>

      <div class="card">
        <h3 class="card-title">ğŸ“Œ After you submit</h3>
        <ul class="simple-list">
          <li>Weâ€™ll review your request.</li>
          <li>Weâ€™ll message you in Support Chat to confirm price and payment.</li>
          <li>Status will update in your Orders list (coming soon).</li>
        </ul>
      </div>
    </div>
  </main>
</div>

<!-- Orders Page (Owner Only) -->
<div id="ordersPage" class="page">
  <header>
    <div class="container">
      <div class="header-content">
        <div class="logo" onclick="showPage('mainPage')">
          <img src="./images/logo.jpg" alt="Bokluy Logo" class="logo-img"
               onerror="this.style.display='none'; this.nextElementSibling.style.display='inline';">
          <span class="logo-text">Bokluy</span>
        </div>
        <div class="nav-buttons">
          <button class="btn btn-primary" onclick="showPage('mainPage')" type="button">
            <span class="btn-icon">â†</span>
            <span>Back</span>
          </button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <div class="container">
      <div class="page-header">
        <h1 class="page-title">ğŸ“¦ Orders</h1>
        <p class="page-subtitle">Owner dashboard for top up requests</p>
      </div>

      <div class="card">
        <div class="orders-toolbar">
          <select id="ordersStatusFilter">
            <option value="all">All</option>
            <option value="pending">Pending</option>
            <option value="processing">Processing</option>
            <option value="completed">Completed</option>
            <option value="cancelled">Cancelled</option>
          </select>
          <button id="ordersRefreshBtn" class="btn btn-dark" type="button">Refresh</button>
        </div>

        <div id="ordersList" class="orders-list">
          <div class="empty-state">
            <div class="empty-state-icon">ğŸ“­</div>
            <p>No orders yet</p>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<!-- Floating Support Chat Widget -->
<button id="chatWidgetFab" class="chat-widget-fab" type="button" aria-label="Open chat">
  ğŸ’¬
  <span id="chatWidgetBadge" class="chat-widget-badge" style="display:none;"></span>
</button>

<div id="chatWidget" class="chat-widget hidden" role="dialog" aria-label="Support chat">
  <div class="chat-widget-header">
    <div class="chat-widget-head">
      <div id="chatWidgetTitle" class="chat-widget-title">Bokluy Support</div>
      <div id="chatWidgetStatus" class="chat-widget-status">Weâ€™ll reply as soon as possible.</div>
    </div>
    <button id="chatWidgetClose" class="chat-widget-close" type="button" aria-label="Close">âœ•</button>
  </div>

  <div id="chatWidgetMessages" class="chat-widget-messages"></div>

  <div class="chat-widget-input">
    <input id="chatWidgetInput" type="text" placeholder="Type a message..." />
    <button id="chatWidgetSend" class="btn btn-primary" type="button">Send</button>
  </div>
</div>

</body>
</html>
